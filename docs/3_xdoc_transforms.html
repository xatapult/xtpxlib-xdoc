<?xml version="1.0" encoding="UTF-8"?>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container">
  
  
  
  
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="resources/bootstrap.min.css"/>
    <link rel="stylesheet" href="resources/xtpxlib-moduledoc.css"/>
    <link rel="shortcut icon" href="resources/favicon.ico"/>
    <title>3 xdoc transforms</title>
  </head>
  <body style="padding-top: 65px;"><nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark"><a class="navbar-brand" href="index.html" title="home">xtpxlib-xdoc</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"/></button><div id="navbarSupportedContent" class="collapse navbar-collapse"><ul class="navbar-nav mr-auto"><li class="nav-item dropdown"><a href="1_Description.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Description <span class="caret"/></a><div class="dropdown-menu"><a href="1_Description.html" class="dropdown-item">Description</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="1_Description.html#sect-main-toolchain">The main toolchain</a></div></li><li class="nav-item dropdown"><a href="2_Instructions.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Instructions <span class="caret"/></a><div class="dropdown-menu"><a href="2_Instructions.html" class="dropdown-item">Instructions</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="2_Instructions.html#d3702e539">Getting started</a><a class="dropdown-item" href="2_Instructions.html#d3702e575">Validation</a><a class="dropdown-item" href="2_Instructions.html#sect-parameter-substitution">Parameter substitution</a><a class="dropdown-item" href="2_Instructions.html#d3702e879">xdoc transforms</a></div></li><li class="nav-item dropdown"><a href="3_xdoc_transforms.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">xdoc transforms <span class="caret"/></a><div class="dropdown-menu"><a href="3_xdoc_transforms.html" class="dropdown-item">xdoc transforms</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="3_xdoc_transforms.html#d3702e1086">Running an xdoc transform</a><a class="dropdown-item" href="3_xdoc_transforms.html#sect-builtin-xdoc-transformations">Built-in xdoc transformations (XProc 1.0)</a><a class="dropdown-item" href="3_xdoc_transforms.html#sect-builtin-xdoc-transformations-3">Built-in xdoc transformations (XProc 3.0)</a><a class="dropdown-item" href="3_xdoc_transforms.html#sect-write-your-own-transformations">Writing your own xdoc transformations</a></div></li><li class="nav-item dropdown"><a href="4_XProc_1.0_support.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XProc 1.0 support <span class="caret"/></a><div class="dropdown-menu"><a href="4_XProc_1.0_support.html" class="dropdown-item">XProc 1.0 support</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="4_XProc_1.0_support.html#docbook-to-pdf.xpl">XProc (1.0) pipeline: docbook-to-pdf.xpl</a><a class="dropdown-item" href="4_XProc_1.0_support.html#docbook-to-xhtml.xpl">XProc (1.0) pipeline: docbook-to-xhtml.xpl</a><a class="dropdown-item" href="4_XProc_1.0_support.html#xdoc-to-docbook.xpl">XProc (1.0) pipeline: xdoc-to-docbook.xpl</a><a class="dropdown-item" href="4_XProc_1.0_support.html#xdoc-to-pdf.xpl">XProc (1.0) pipeline: xdoc-to-pdf.xpl</a><a class="dropdown-item" href="4_XProc_1.0_support.html#xdoc-to-xhtml.xpl">XProc (1.0) pipeline: xdoc-to-xhtml.xpl</a><a class="dropdown-item" href="4_XProc_1.0_support.html#xtpxlib-xdoc.mod.xpl">XProc (1.0) library: xtpxlib-xdoc.mod.xpl</a></div></li><li class="nav-item dropdown"><a href="5_XProc_3.0_support.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XProc 3.0 support <span class="caret"/></a><div class="dropdown-menu"><a href="5_XProc_3.0_support.html" class="dropdown-item">XProc 3.0 support</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-docbook-to-pdf.xpl">XProc (3.0) pipeline: docbook-to-pdf.xpl</a><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-docbook-to-xhtml.xpl">XProc (3.0) pipeline: docbook-to-xhtml.xpl</a><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-xdoc-to-docbook.xpl">XProc (3.0) pipeline: xdoc-to-docbook.xpl</a><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-xdoc-to-pdf.xpl">XProc (3.0) pipeline: xdoc-to-pdf.xpl</a><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-xdoc-to-xhtml.xpl">XProc (3.0) pipeline: xdoc-to-xhtml.xpl</a><a class="dropdown-item" href="5_XProc_3.0_support.html#xpl3-xtpxlib-xdoc.mod.xpl">XProc (3.0) library: xtpxlib-xdoc.mod.xpl</a></div></li><li class="nav-item dropdown"><a href="6_DocBook_dialect.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">DocBook dialect <span class="caret"/></a><div class="dropdown-menu"><a href="6_DocBook_dialect.html" class="dropdown-item">DocBook dialect</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="6_DocBook_dialect.html#d3702e5041">Supported root elements</a><a class="dropdown-item" href="6_DocBook_dialect.html#sect-docbook5">Document information</a><a class="dropdown-item" href="6_DocBook_dialect.html#d3702e5091">Chapter/Section structure</a><a class="dropdown-item" href="6_DocBook_dialect.html#d3702e5139">Block constructions</a><a class="dropdown-item" href="6_DocBook_dialect.html#d3702e5770">Inline elements</a><a class="dropdown-item" href="6_DocBook_dialect.html#d3702e6442">Other constructs</a><a class="dropdown-item" href="6_DocBook_dialect.html#sect-fixed-width-column-mechanism">Fixed-width column mechanism</a></div></li><li class="nav-item"><a class="nav-link" href="resources/xtpxlib-xdoc-documentation.pdf" title="PDF version of this documentation site">PDF</a></li></ul></div></nav><div class="container"><a name="chapter-xdoc-transforms"><!----></a><div class="page-header" style="padding-top: 65px; margin-top: -65px;"><h1 class="chapter"><span class="chapter-number">3 </span><code class="code">xdoc</code> transforms</h1></div><p class="para" id="d3702e1069"><a name="d3702e1069"><!----></a>An <code class="code">xdoc</code> transform is an XSLT stylesheet or XProc (1.0) pipeline that is triggered from your source document and inserts generated
    DocBook contents. There are several of these <a href="#sect-builtin-xdoc-transformations"><span class="link">transforms built into the
        <code class="code">xtpxlib-xdoc</code> component</span></a> but its also easy to <a href="#sect-write-your-own-transformations"><span class="link">write one of your
      own</span></a>.</p><div class="sect1" id="d3702e1086"><a name="d3702e1086"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">3.1</span> Running an <code class="code">xdoc</code> transform</h2><p class="para" id="d3702e1094"><a name="d3702e1094"><!----></a>The <code class="tag">&lt;xdoc:transform&gt;</code>extension element runs an <code class="code">xdoc</code> transformation (either XProc (1.0) or XSLT (2.0 or 3.0)). It is
      completely replaced by the outcome of the transformation.</p><div class="programlisting" id="xdoc-transform-xlisting"><a name="xdoc-transform-xlisting"><!----></a><pre class="programlisting">&lt;xdoc:transform href = xs:anyURI
                (any)? &gt;
  &lt;!-- (Optional) XML to transform and/or an &lt;xi:include&gt; element to load this from an external source. --&gt;
&lt;/xdoc:transform&gt;</pre></div><p style="font-size: 50%;" class="para halfbreak" id="d3702e1105"><a name="d3702e1105"><!----></a> </p><div class="table nonumber" id="xdoc-transform-attributes"><a name="xdoc-transform-attributes"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1113" class="thead-light"><tr id="d3702e1114"><th id="d3702e1115"><a name="d3702e1115"><!----></a><a name="d3702e1116"><!----></a>Attribute</th><th id="d3702e1118"><a name="d3702e1118"><!----></a>#</th><th id="d3702e1120"><a name="d3702e1120"><!----></a><a name="d3702e1121"><!----></a>Type</th><th id="d3702e1123"><a name="d3702e1123"><!----></a><a name="d3702e1124"><!----></a>Description</th></tr></thead><tbody id="d3702e1126"><tr id="d3702e1127"><td id="d3702e1128"><a name="d3702e1128"><!----></a><a name="d3702e1129"><!----></a><code class="code code-width-limited">href</code></td><td id="d3702e1132"><a name="d3702e1132"><!----></a><a name="d3702e1133"><!----></a>1</td><td id="d3702e1135"><a name="d3702e1135"><!----></a><a name="d3702e1136"><!----></a><code class="code code-width-limited">xs:anyURI</code></td><td id="d3702e1139"><a name="d3702e1139"><!----></a><a name="d3702e1140"><!----></a>Reference to the actual transformation. Relative names are resolved against the location of the source document.<br/><a name="d3702e1142"><!----></a>This file's extension determines whether an XProc 1.0 (extension: <code class="code">.xpl</code>) or an XSLT (extension: <code class="code">.xsl</code>) is
        done.<br/><a name="d3702e1150"><!----></a>A value that starts with <code class="code">$xdoc</code> is assumed to be an <code class="code">xtpxlib-xdoc</code> built-in transformation (e.g.
          <code class="code">href="$xdoc/code-docgen.xpl"</code>). See also <a href="#sect-builtin-xdoc-transformations" class="xref">3.2 Built-in xdoc transformations (XProc 1.0)</a>.</td></tr><tr id="d3702e1163"><td id="d3702e1164"><a name="d3702e1164"><!----></a><a name="d3702e1165"><!----></a><code class="code code-width-limited">(any)</code></td><td id="d3702e1168"><a name="d3702e1168"><!----></a><a name="d3702e1169"><!----></a>?</td><td id="d3702e1171"><a name="d3702e1171"><!----></a></td><td id="d3702e1172"><a name="d3702e1172"><!----></a><a name="d3702e1173"><!----></a>Often transformations specify additional attributes on the <code class="tag">&lt;xdoc:transform&gt;</code> element to parametrize their functionality. Any
        additional attribute is allowed here.</td></tr></tbody></table></div></div><div class="sect1" id="sect-builtin-xdoc-transformations"><a name="sect-builtin-xdoc-transformations"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">3.2</span> Built-in <code class="code">xdoc</code> transformations (XProc 1.0)</h2><p class="para" id="d3702e1191"><a name="d3702e1191"><!----></a>The <code class="code">xtpxlib-xdoc</code> has several transforms built in that use XProc 1.0. You can easily reference these by prefixing
      their name with <code class="code">$xdoc</code>, for instance <code class="code">$xdoc/code-docgen.xpl</code>.  If you use the XProc 1.0 `xdoc` pipelines, these transforms are
      automatically used.</p><div class="table" id="d3702e1203"><a name="d3702e1203"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1209" class="thead-light"><tr id="d3702e1210"><th id="d3702e1211"><a name="d3702e1211"><!----></a>Module/Pipeline</th><th id="d3702e1213"><a name="d3702e1213"><!----></a>Description</th></tr></thead><tbody id="d3702e1215"><tr id="d3702e1216"><td id="d3702e1217"><a name="d3702e1217"><!----></a><a name="d3702e1218"><!----></a><code class="code code-width-limited"><a href="#code-docgen-dir.xpl"><span class="link">code-docgen-dir.xpl</span></a></code></td><td id="d3702e1222"><a name="d3702e1222"><!----></a><a name="d3702e1223"><!----></a>Runs the <code class="code"><a href="#code-docgen.xpl"><span class="link">$xdoc/code-docgen.xpl</span></a></code> transform over multiple files in a directory.</td></tr><tr id="d3702e1229"><td id="d3702e1230"><a name="d3702e1230"><!----></a><a name="d3702e1231"><!----></a><code class="code code-width-limited"><a href="#code-docgen.xpl"><span class="link">code-docgen.xpl</span></a></code></td><td id="d3702e1235"><a name="d3702e1235"><!----></a><a name="d3702e1236"><!----></a>Takes an XML document (XSL, XSD, XProc, ordinary XML) and generates documentation out of it.</td></tr><tr id="d3702e1238"><td id="d3702e1239"><a name="d3702e1239"><!----></a><a name="d3702e1240"><!----></a><code class="code code-width-limited"><a href="#include-docbook.xpl"><span class="link">include-docbook.xpl</span></a></code></td><td id="d3702e1244"><a name="d3702e1244"><!----></a><a name="d3702e1245"><!----></a>Takes an XML document and unwraps the root element from it. It then copies all the children to the output, with the exception of any <code class="code">db:info</code> elements.</td></tr><tr id="d3702e1250"><td id="d3702e1251"><a name="d3702e1251"><!----></a><a name="d3702e1252"><!----></a><code class="code code-width-limited"><a href="#xml-description.xpl"><span class="link">xml-description.xpl</span></a></code></td><td id="d3702e1256"><a name="d3702e1256"><!----></a><a name="d3702e1257"><!----></a>Takes a document that <span class="emphasis italic">describes</span> an XML document, using special markup for this, and turns this into DocBook.</td></tr></tbody></table></div><div class="sect2" id="code-docgen-dir.xpl"><a name="code-docgen-dir.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.2.1</span> XProc (1.0) pipeline: <code class="code">code-docgen-dir.xpl</code></h3><p class="para keep-with-next" id="d3702e1267"><a name="d3702e1267"><!----></a>File: <code class="code">transforms/code-docgen-dir.xpl</code></p><p class="para" id="d3702e1271"><a name="d3702e1271"><!----></a>Runs the <code class="code"><a href="#code-docgen.xpl"><span class="link">$xdoc/code-docgen.xpl</span></a></code> transform over multiple files in a directory.</p><p class="para" id="d3702e1277"><a name="d3702e1277"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1282"><a name="d3702e1282"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/code-docgen-dir.xpl"
   dir="…"
   depth="…"
   filter="…"
   toc-only="…"
   id-suffix="…" &gt;</pre></div><ul class="itemizedlist" id="d3702e1284"><a name="d3702e1284"><!----></a><li id="d3702e1285"><a name="d3702e1285"><!----></a><p class="para" id="d3702e1286"><a name="d3702e1286"><!----></a><code class="code">@dir</code>: Directory to process</p></li><li id="d3702e1290"><a name="d3702e1290"><!----></a><p class="para" id="d3702e1291"><a name="d3702e1291"><!----></a><code class="code">@depth</code>: (integer, default -1) The depth in traversing the directory tree.</p><ul class="itemizedlist" id="d3702e1295"><a name="d3702e1295"><!----></a><li id="d3702e1296"><a name="d3702e1296"><!----></a><p class="para" id="d3702e1297"><a name="d3702e1297"><!----></a>When le 0, <code class="code">@dir</code> and all its subdirectories are processed.</p></li><li id="d3702e1302"><a name="d3702e1302"><!----></a><p class="para" id="d3702e1303"><a name="d3702e1303"><!----></a>When eq 1, only <code class="code">@dir</code> is processed.</p></li><li id="d3702e1308"><a name="d3702e1308"><!----></a><p class="para" id="d3702e1309"><a name="d3702e1309"><!----></a>When gt 1, the sub-directories up to this depth are processed.</p></li></ul></li><li id="d3702e1311"><a name="d3702e1311"><!----></a><p class="para" id="d3702e1312"><a name="d3702e1312"><!----></a><code class="code">@filter</code>: optional regexp filter (e.g. get only XProc files with <code class="code">filter="\.xpl$"</code>)</p></li><li id="d3702e1319"><a name="d3702e1319"><!----></a><p class="para" id="d3702e1320"><a name="d3702e1320"><!----></a><code class="code">@toc-only</code>: (boolean, default <code class="code">false</code>) Whether to produce a ToC table only.</p></li><li id="d3702e1327"><a name="d3702e1327"><!----></a><p class="para" id="d3702e1328"><a name="d3702e1328"><!----></a><code class="code">@id-suffix</code>: Optional suffix for creating an id based on the filename.</p></li></ul><p class="para" id="d3702e1332"><a name="d3702e1332"><!----></a>All (other) attributes are passed to <code class="code">code-docgen.xpl</code>.</p><div class="table nonumber" id="d3702e1337"><a name="d3702e1337"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1344" class="thead-light"><tr id="d3702e1345"><th id="d3702e1346"><a name="d3702e1346"><!----></a>Port</th><th id="d3702e1348"><a name="d3702e1348"><!----></a>Type</th><th id="d3702e1350"><a name="d3702e1350"><!----></a>Primary?</th><th id="d3702e1352"><a name="d3702e1352"><!----></a>Description</th></tr></thead><tbody id="d3702e1354"><tr id="d3702e1355"><td id="d3702e1356"><a name="d3702e1356"><!----></a><a name="d3702e1357"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e1360"><a name="d3702e1360"><!----></a>in</td><td id="d3702e1362"><a name="d3702e1362"><!----></a>yes</td><td id="d3702e1364"><a name="d3702e1364"><!----></a><a name="d3702e1365"><!----></a>The triggering <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e1370"><td id="d3702e1371"><a name="d3702e1371"><!----></a><a name="d3702e1372"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e1375"><a name="d3702e1375"><!----></a>out</td><td id="d3702e1377"><a name="d3702e1377"><!----></a>yes</td><td id="d3702e1379"><a name="d3702e1379"><!----></a><a name="d3702e1380"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="code-docgen.xpl"><a name="code-docgen.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.2.2</span> XProc (1.0) pipeline: <code class="code">code-docgen.xpl</code></h3><p class="para keep-with-next" id="d3702e1387"><a name="d3702e1387"><!----></a>File: <code class="code">transforms/code-docgen.xpl</code></p><p class="para" id="d3702e1391"><a name="d3702e1391"><!----></a>Type: <code class="code">xdoc:code-docgen</code></p><p class="para" id="d3702e1395"><a name="d3702e1395"><!----></a>Takes an XML document (XSL, XSD, XProc, ordinary XML) and generates documentation out of it.</p><p class="para" id="d3702e1397"><a name="d3702e1397"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1402"><a name="d3702e1402"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/code-docgen.xpl"
   filecomponents="…"
   header-level="…"
   add-table-titles="…"
   sublevels="…"
   id="…"
   id-suffix="…" &gt;
  &lt;xi:include href="path/to/document/to/generate/documentation/for"/&gt;
&lt;/xdoc:transform&gt;</pre></div><ul class="itemizedlist" id="d3702e1404"><a name="d3702e1404"><!----></a><li id="d3702e1405"><a name="d3702e1405"><!----></a><p class="para" id="d3702e1406"><a name="d3702e1406"><!----></a><code class="code">@filecomponents</code>: (integer, default 0)Determines the display of the filename:</p><ul class="itemizedlist" id="d3702e1410"><a name="d3702e1410"><!----></a><li id="d3702e1411"><a name="d3702e1411"><!----></a><p class="para" id="d3702e1412"><a name="d3702e1412"><!----></a>When lt 0, no filename is displayed</p></li><li id="d3702e1414"><a name="d3702e1414"><!----></a><p class="para" id="d3702e1415"><a name="d3702e1415"><!----></a>When eq 0, the full filename (with full path) is displayed</p></li><li id="d3702e1417"><a name="d3702e1417"><!----></a><p class="para" id="d3702e1418"><a name="d3702e1418"><!----></a>When gt 0, this number of filename components is displayed. So 1 means filename only, 2 means filename and direct foldername, etc.</p></li></ul></li><li id="d3702e1420"><a name="d3702e1420"><!----></a><p class="para" id="d3702e1421"><a name="d3702e1421"><!----></a><code class="code">@header-level</code>: (integer, default 0)Determines what kind of DocBook section is created:</p><ul class="itemizedlist" id="d3702e1425"><a name="d3702e1425"><!----></a><li id="d3702e1426"><a name="d3702e1426"><!----></a><p class="para" id="d3702e1427"><a name="d3702e1427"><!----></a>When le 0, no separate section is created, all titles will be output as <code class="code">bridgehead</code> elements.</p></li><li id="d3702e1432"><a name="d3702e1432"><!----></a><p class="para" id="d3702e1433"><a name="d3702e1433"><!----></a>Otherwise a title with this level is created (e.g. <code class="code">header-level="1"</code> means a <code class="code">sect1</code> element).</p></li></ul></li><li id="d3702e1441"><a name="d3702e1441"><!----></a><p class="para" id="d3702e1442"><a name="d3702e1442"><!----></a><code class="code">@add-table-titles</code>: (boolean, default <code class="code">false</code>) Whether to add titles to generated tables.</p></li><li id="d3702e1449"><a name="d3702e1449"><!----></a><p class="para" id="d3702e1450"><a name="d3702e1450"><!----></a><code class="code">@sublevels</code>: (boolean, default <code class="code">true</code>) If true only the main section will be a "real" section. All sublevels will become bridgeheads.</p></li><li id="d3702e1457"><a name="d3702e1457"><!----></a><p class="para" id="d3702e1458"><a name="d3702e1458"><!----></a><code class="code">@id</code>: Optional identifier of this section. If absent the id will become the document's filename, optionally suffixed with <code class="code">@id-suffix</code>.</p></li><li id="d3702e1465"><a name="d3702e1465"><!----></a><p class="para" id="d3702e1466"><a name="d3702e1466"><!----></a><code class="code">@id-suffix</code>: Optional suffix for creating an id based on the filename.</p></li></ul><p class="para" id="d3702e1470"><a name="d3702e1470"><!----></a>If the format to document has means to add documentation of itself (like XProc (<code class="code">p:documentation</code>) or XML Schema (<code class="code">xs:annotation</code>)), this is used. If there is no such thing (like for XSLT and straight XML), comments starting with a tilde (<code class="code">~</code>) are used.</p><p class="para" id="d3702e1481"><a name="d3702e1481"><!----></a>All descriptions and documentation sections can contain simple Markdown.</p><p class="para" id="d3702e1483"><a name="d3702e1483"><!----></a>The following formats are supported</p><ul class="itemizedlist" id="d3702e1485"><a name="d3702e1485"><!----></a><li id="d3702e1486"><a name="d3702e1486"><!----></a><p class="para" id="d3702e1487"><a name="d3702e1487"><!----></a>XML documents: only the header comment is used.</p></li><li id="d3702e1489"><a name="d3702e1489"><!----></a><p class="para" id="d3702e1490"><a name="d3702e1490"><!----></a>XSLT (2.0 and 3.0) stylesheets: document all <span class="emphasis italic">exported</span> parameters, variables, functions and named templates. Something is supposed to be for export if its <span class="emphasis italic">not</span> in the no or local namespace.</p></li><li id="d3702e1498"><a name="d3702e1498"><!----></a><p class="para" id="d3702e1499"><a name="d3702e1499"><!----></a>XProc pipelines and libraries</p></li><li id="d3702e1501"><a name="d3702e1501"><!----></a><p class="para" id="d3702e1502"><a name="d3702e1502"><!----></a>XML Schemas: Uses the global annotation and lists the global elements using their annotations.</p></li></ul><div class="table nonumber" id="d3702e1505"><a name="d3702e1505"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1512" class="thead-light"><tr id="d3702e1513"><th id="d3702e1514"><a name="d3702e1514"><!----></a>Port</th><th id="d3702e1516"><a name="d3702e1516"><!----></a>Type</th><th id="d3702e1518"><a name="d3702e1518"><!----></a>Primary?</th><th id="d3702e1520"><a name="d3702e1520"><!----></a>Description</th></tr></thead><tbody id="d3702e1522"><tr id="d3702e1523"><td id="d3702e1524"><a name="d3702e1524"><!----></a><a name="d3702e1525"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e1528"><a name="d3702e1528"><!----></a>in</td><td id="d3702e1530"><a name="d3702e1530"><!----></a>yes</td><td id="d3702e1532"><a name="d3702e1532"><!----></a><a name="d3702e1533"><!----></a>The document to generate documentation for, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e1538"><td id="d3702e1539"><a name="d3702e1539"><!----></a><a name="d3702e1540"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e1543"><a name="d3702e1543"><!----></a>out</td><td id="d3702e1545"><a name="d3702e1545"><!----></a>yes</td><td id="d3702e1547"><a name="d3702e1547"><!----></a><a name="d3702e1548"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="include-docbook.xpl"><a name="include-docbook.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.2.3</span> XProc (1.0) pipeline: <code class="code">include-docbook.xpl</code></h3><p class="para keep-with-next" id="d3702e1555"><a name="d3702e1555"><!----></a>File: <code class="code">transforms/include-docbook.xpl</code></p><p class="para" id="d3702e1559"><a name="d3702e1559"><!----></a>Takes an XML document and unwraps the root element from it. It then copies all the children to the output, with the exception of any <code class="code">db:info</code> elements.</p><p class="para" id="d3702e1564"><a name="d3702e1564"><!----></a>It is the responsibility of the author to make sure that everything that results is in the DocBook (<code class="code">http://docbook.org/ns/docbook</code>) namespace!</p><p class="para" id="d3702e1569"><a name="d3702e1569"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1574"><a name="d3702e1574"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/include-docbook.xpl&gt;
  &lt;xi:include href="path/to/xml/to/include.xml"/&gt;
&lt;/xdoc:transform&gt;</pre></div><div class="table nonumber" id="d3702e1576"><a name="d3702e1576"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1583" class="thead-light"><tr id="d3702e1584"><th id="d3702e1585"><a name="d3702e1585"><!----></a>Port</th><th id="d3702e1587"><a name="d3702e1587"><!----></a>Type</th><th id="d3702e1589"><a name="d3702e1589"><!----></a>Primary?</th><th id="d3702e1591"><a name="d3702e1591"><!----></a>Description</th></tr></thead><tbody id="d3702e1593"><tr id="d3702e1594"><td id="d3702e1595"><a name="d3702e1595"><!----></a><a name="d3702e1596"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e1599"><a name="d3702e1599"><!----></a>in</td><td id="d3702e1601"><a name="d3702e1601"><!----></a>yes</td><td id="d3702e1603"><a name="d3702e1603"><!----></a><a name="d3702e1604"><!----></a>The document containing the parts to include, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e1609"><td id="d3702e1610"><a name="d3702e1610"><!----></a><a name="d3702e1611"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e1614"><a name="d3702e1614"><!----></a>out</td><td id="d3702e1616"><a name="d3702e1616"><!----></a>yes</td><td id="d3702e1618"><a name="d3702e1618"><!----></a><a name="d3702e1619"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="xml-description.xpl"><a name="xml-description.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.2.4</span> XProc (1.0) pipeline: <code class="code">xml-description.xpl</code></h3><p class="para keep-with-next" id="d3702e1626"><a name="d3702e1626"><!----></a>File: <code class="code">transforms/xml-description.xpl</code></p><p class="para" id="d3702e1630"><a name="d3702e1630"><!----></a>Takes a document that <span class="emphasis italic">describes</span> an XML document, using special markup for this, and turns this into DocBook.</p><p class="para" id="d3702e1635"><a name="d3702e1635"><!----></a>A schema for this markup format can be found in <code class="code">xsd/element-description.xml</code>.</p><p class="para" id="d3702e1640"><a name="d3702e1640"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1645"><a name="d3702e1645"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/xml-description.xpl&gt;
  &lt;xi:include href="path/to/xml/description.xml"/&gt;
&lt;/xdoc:transform&gt;</pre></div><div class="table nonumber" id="d3702e1647"><a name="d3702e1647"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1654" class="thead-light"><tr id="d3702e1655"><th id="d3702e1656"><a name="d3702e1656"><!----></a>Port</th><th id="d3702e1658"><a name="d3702e1658"><!----></a>Type</th><th id="d3702e1660"><a name="d3702e1660"><!----></a>Primary?</th><th id="d3702e1662"><a name="d3702e1662"><!----></a>Description</th></tr></thead><tbody id="d3702e1664"><tr id="d3702e1665"><td id="d3702e1666"><a name="d3702e1666"><!----></a><a name="d3702e1667"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e1670"><a name="d3702e1670"><!----></a>in</td><td id="d3702e1672"><a name="d3702e1672"><!----></a>yes</td><td id="d3702e1674"><a name="d3702e1674"><!----></a><a name="d3702e1675"><!----></a>The document containing the XML description, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e1680"><td id="d3702e1681"><a name="d3702e1681"><!----></a><a name="d3702e1682"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e1685"><a name="d3702e1685"><!----></a>out</td><td id="d3702e1687"><a name="d3702e1687"><!----></a>yes</td><td id="d3702e1689"><a name="d3702e1689"><!----></a><a name="d3702e1690"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div></div><div class="sect1" id="sect-builtin-xdoc-transformations-3"><a name="sect-builtin-xdoc-transformations-3"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">3.3</span> Built-in <code class="code">xdoc</code> transformations (XProc 3.0)</h2><p class="para" id="d3702e1704"><a name="d3702e1704"><!----></a>The <code class="code">xtpxlib-xdoc</code> has several transforms built in. You also reference these by prefixing their name with
      <code class="code">$xdoc</code>, for instance <code class="code">$xdoc/code-docgen.xpl</code>. If you use the XProc 3.0 `xdoc` pipelines, these transforms are
      automatically used.</p><div class="table" id="d3702e1716"><a name="d3702e1716"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1722" class="thead-light"><tr id="d3702e1723"><th id="d3702e1724"><a name="d3702e1724"><!----></a>Module/Pipeline</th><th id="d3702e1726"><a name="d3702e1726"><!----></a>Description</th></tr></thead><tbody id="d3702e1728"><tr id="d3702e1729"><td id="d3702e1730"><a name="d3702e1730"><!----></a><a name="d3702e1731"><!----></a><code class="code code-width-limited"><a href="#xpl3-code-docgen-dir.xpl"><span class="link">code-docgen-dir.xpl</span></a></code></td><td id="d3702e1735"><a name="d3702e1735"><!----></a><a name="d3702e1736"><!----></a>Runs the <code class="code"><a href="#code-docgen.xpl"><span class="link">$xdoc/code-docgen.xpl</span></a></code> transform over multiple files in a directory.</td></tr><tr id="d3702e1742"><td id="d3702e1743"><a name="d3702e1743"><!----></a><a name="d3702e1744"><!----></a><code class="code code-width-limited"><a href="#xpl3-code-docgen.xpl"><span class="link">code-docgen.xpl</span></a></code></td><td id="d3702e1748"><a name="d3702e1748"><!----></a><a name="d3702e1749"><!----></a>Takes an XML document (XSL, XSD, XProc, ordinary XML) and generates documentation out of it.</td></tr><tr id="d3702e1751"><td id="d3702e1752"><a name="d3702e1752"><!----></a><a name="d3702e1753"><!----></a><code class="code code-width-limited"><a href="#xpl3-include-docbook.xpl"><span class="link">include-docbook.xpl</span></a></code></td><td id="d3702e1757"><a name="d3702e1757"><!----></a><a name="d3702e1758"><!----></a>Takes an XML document and unwraps the root element from it. It then copies all the children to the output, with the exception of any <code class="code">db:info</code> elements.</td></tr><tr id="d3702e1763"><td id="d3702e1764"><a name="d3702e1764"><!----></a><a name="d3702e1765"><!----></a><code class="code code-width-limited"><a href="#xpl3-xml-description.xpl"><span class="link">xml-description.xpl</span></a></code></td><td id="d3702e1769"><a name="d3702e1769"><!----></a><a name="d3702e1770"><!----></a>Takes a document that <span class="emphasis italic">describes</span> an XML document, using special markup for this, and turns this into DocBook.</td></tr></tbody></table></div><div class="sect2" id="xpl3-code-docgen-dir.xpl"><a name="xpl3-code-docgen-dir.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.3.1</span> XProc (3.0) pipeline: <code class="code">code-docgen-dir.xpl</code></h3><p class="para keep-with-next" id="d3702e1780"><a name="d3702e1780"><!----></a>File: <code class="code">transforms3/code-docgen-dir.xpl</code></p><p class="para" id="d3702e1784"><a name="d3702e1784"><!----></a>Type: <code class="code">xdoc:code-docgen-dir</code></p><p class="para" id="d3702e1788"><a name="d3702e1788"><!----></a>Runs the <code class="code"><a href="#code-docgen.xpl"><span class="link">$xdoc/code-docgen.xpl</span></a></code> transform over multiple files in a directory.</p><p class="para" id="d3702e1794"><a name="d3702e1794"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1799"><a name="d3702e1799"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/code-docgen-dir.xpl"
   dir="…"
   depth="…"
   filter="…"
   toc-only="…"
   id-suffix="…" &gt;</pre></div><ul class="itemizedlist" id="d3702e1801"><a name="d3702e1801"><!----></a><li id="d3702e1802"><a name="d3702e1802"><!----></a><p class="para" id="d3702e1803"><a name="d3702e1803"><!----></a><code class="code">@dir</code>: Directory to process</p></li><li id="d3702e1807"><a name="d3702e1807"><!----></a><p class="para" id="d3702e1808"><a name="d3702e1808"><!----></a><code class="code">@depth</code>: (integer, default -1) The depth in traversing the directory tree.</p><ul class="itemizedlist" id="d3702e1812"><a name="d3702e1812"><!----></a><li id="d3702e1813"><a name="d3702e1813"><!----></a><p class="para" id="d3702e1814"><a name="d3702e1814"><!----></a>When le 0, <code class="code">@dir</code> and all its subdirectories are processed.</p></li><li id="d3702e1819"><a name="d3702e1819"><!----></a><p class="para" id="d3702e1820"><a name="d3702e1820"><!----></a>When eq 1, only <code class="code">@dir</code> is processed.</p></li><li id="d3702e1825"><a name="d3702e1825"><!----></a><p class="para" id="d3702e1826"><a name="d3702e1826"><!----></a>When gt 1, the sub-directories up to this depth are processed.</p></li></ul></li><li id="d3702e1828"><a name="d3702e1828"><!----></a><p class="para" id="d3702e1829"><a name="d3702e1829"><!----></a><code class="code">@filter</code>: optional regexp filter (e.g. get only XProc files with <code class="code">filter="\.xpl$"</code>)</p></li><li id="d3702e1836"><a name="d3702e1836"><!----></a><p class="para" id="d3702e1837"><a name="d3702e1837"><!----></a><code class="code">@toc-only</code>: (boolean, default <code class="code">false</code>) Whether to produce a ToC table only.</p></li><li id="d3702e1844"><a name="d3702e1844"><!----></a><p class="para" id="d3702e1845"><a name="d3702e1845"><!----></a><code class="code">@id-suffix</code>: Optional suffix for creating an id based on the filename.</p></li></ul><div class="table nonumber" id="d3702e1849"><a name="d3702e1849"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e1856" class="thead-light"><tr id="d3702e1857"><th id="d3702e1858"><a name="d3702e1858"><!----></a>Port</th><th id="d3702e1860"><a name="d3702e1860"><!----></a>Type</th><th id="d3702e1862"><a name="d3702e1862"><!----></a>Primary?</th><th id="d3702e1864"><a name="d3702e1864"><!----></a>Description</th></tr></thead><tbody id="d3702e1866"><tr id="d3702e1867"><td id="d3702e1868"><a name="d3702e1868"><!----></a><a name="d3702e1869"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e1872"><a name="d3702e1872"><!----></a>in</td><td id="d3702e1874"><a name="d3702e1874"><!----></a>yes</td><td id="d3702e1876"><a name="d3702e1876"><!----></a><a name="d3702e1877"><!----></a>The triggering <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e1882"><td id="d3702e1883"><a name="d3702e1883"><!----></a><a name="d3702e1884"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e1887"><a name="d3702e1887"><!----></a>out</td><td id="d3702e1889"><a name="d3702e1889"><!----></a>yes</td><td id="d3702e1891"><a name="d3702e1891"><!----></a><a name="d3702e1892"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="xpl3-code-docgen.xpl"><a name="xpl3-code-docgen.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.3.2</span> XProc (3.0) pipeline: <code class="code">code-docgen.xpl</code></h3><p class="para keep-with-next" id="d3702e1899"><a name="d3702e1899"><!----></a>File: <code class="code">transforms3/code-docgen.xpl</code></p><p class="para" id="d3702e1903"><a name="d3702e1903"><!----></a>Type: <code class="code">xdoc:code-docgen</code></p><p class="para" id="d3702e1907"><a name="d3702e1907"><!----></a>Takes an XML document (XSL, XSD, XProc, ordinary XML) and generates documentation out of it.</p><p class="para" id="d3702e1909"><a name="d3702e1909"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e1914"><a name="d3702e1914"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/code-docgen.xpl"
   filecomponents="…"
   header-level="…"
   add-table-titles="…"
   sublevels="…"
   id="…"
   id-suffix="…" &gt;
  &lt;xi:include href="path/to/document/to/generate/documentation/for"/&gt;
&lt;/xdoc:transform&gt;</pre></div><ul class="itemizedlist" id="d3702e1916"><a name="d3702e1916"><!----></a><li id="d3702e1917"><a name="d3702e1917"><!----></a><p class="para" id="d3702e1918"><a name="d3702e1918"><!----></a><code class="code">@filecomponents</code>: (integer, default 0)Determines the display of the filename:</p><ul class="itemizedlist" id="d3702e1922"><a name="d3702e1922"><!----></a><li id="d3702e1923"><a name="d3702e1923"><!----></a><p class="para" id="d3702e1924"><a name="d3702e1924"><!----></a>When lt 0, no filename is displayed</p></li><li id="d3702e1926"><a name="d3702e1926"><!----></a><p class="para" id="d3702e1927"><a name="d3702e1927"><!----></a>When eq 0, the full filename (with full path) is displayed</p></li><li id="d3702e1929"><a name="d3702e1929"><!----></a><p class="para" id="d3702e1930"><a name="d3702e1930"><!----></a>When gt 0, this number of filename components is displayed. So 1 means filename only, 2 means filename and direct foldername, etc.</p></li></ul></li><li id="d3702e1932"><a name="d3702e1932"><!----></a><p class="para" id="d3702e1933"><a name="d3702e1933"><!----></a><code class="code">@header-level</code>: (integer, default 0)Determines what kind of DocBook section is created:</p><ul class="itemizedlist" id="d3702e1937"><a name="d3702e1937"><!----></a><li id="d3702e1938"><a name="d3702e1938"><!----></a><p class="para" id="d3702e1939"><a name="d3702e1939"><!----></a>When le 0, no separate section is created, all titles will be output as <code class="code">bridgehead</code> elements.</p></li><li id="d3702e1944"><a name="d3702e1944"><!----></a><p class="para" id="d3702e1945"><a name="d3702e1945"><!----></a>Otherwise a title with this level is created (e.g. <code class="code">header-level="1"</code> means a <code class="code">sect1</code> element).</p></li></ul></li><li id="d3702e1953"><a name="d3702e1953"><!----></a><p class="para" id="d3702e1954"><a name="d3702e1954"><!----></a><code class="code">@add-table-titles</code>: (boolean, default <code class="code">false</code>) Whether to add titles to generated tables.</p></li><li id="d3702e1961"><a name="d3702e1961"><!----></a><p class="para" id="d3702e1962"><a name="d3702e1962"><!----></a><code class="code">@sublevels</code>: (boolean, default <code class="code">true</code>) If true only the main section will be a "real" section. All sublevels will become bridgeheads.</p></li><li id="d3702e1969"><a name="d3702e1969"><!----></a><p class="para" id="d3702e1970"><a name="d3702e1970"><!----></a><code class="code">@id</code>: Optional identifier of this section. If absent the id will become the document's filename, optionally suffixed with <code class="code">@id-suffix</code>.</p></li><li id="d3702e1977"><a name="d3702e1977"><!----></a><p class="para" id="d3702e1978"><a name="d3702e1978"><!----></a><code class="code">@id-suffix</code>: Optional suffix for creating an id based on the filename.</p></li></ul><p class="para" id="d3702e1982"><a name="d3702e1982"><!----></a>If the format to document has means to add documentation of itself (like XProc (<code class="code">p:documentation</code>) or XML Schema (<code class="code">xs:annotation</code>)), this is used. If there is no such thing (like for XSLT and straight XML), comments starting with a tilde (<code class="code">~</code>) are used.</p><p class="para" id="d3702e1993"><a name="d3702e1993"><!----></a>All descriptions and documentation sections can contain simple Markdown.</p><p class="para" id="d3702e1995"><a name="d3702e1995"><!----></a>The following formats are supported</p><ul class="itemizedlist" id="d3702e1997"><a name="d3702e1997"><!----></a><li id="d3702e1998"><a name="d3702e1998"><!----></a><p class="para" id="d3702e1999"><a name="d3702e1999"><!----></a>XML documents: only the header comment is used.</p></li><li id="d3702e2001"><a name="d3702e2001"><!----></a><p class="para" id="d3702e2002"><a name="d3702e2002"><!----></a>XSLT (2.0 and 3.0) stylesheets: document all <span class="emphasis italic">exported</span> parameters, variables, functions and named templates. Something is supposed to be for export if its <span class="emphasis italic">not</span> in the no or local namespace.</p></li><li id="d3702e2010"><a name="d3702e2010"><!----></a><p class="para" id="d3702e2011"><a name="d3702e2011"><!----></a>XProc pipelines and libraries</p></li><li id="d3702e2013"><a name="d3702e2013"><!----></a><p class="para" id="d3702e2014"><a name="d3702e2014"><!----></a>XML Schemas: Uses the global annotation and lists the global elements using their annotations.</p></li></ul><div class="table nonumber" id="d3702e2017"><a name="d3702e2017"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e2024" class="thead-light"><tr id="d3702e2025"><th id="d3702e2026"><a name="d3702e2026"><!----></a>Port</th><th id="d3702e2028"><a name="d3702e2028"><!----></a>Type</th><th id="d3702e2030"><a name="d3702e2030"><!----></a>Primary?</th><th id="d3702e2032"><a name="d3702e2032"><!----></a>Description</th></tr></thead><tbody id="d3702e2034"><tr id="d3702e2035"><td id="d3702e2036"><a name="d3702e2036"><!----></a><a name="d3702e2037"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e2040"><a name="d3702e2040"><!----></a>in</td><td id="d3702e2042"><a name="d3702e2042"><!----></a>yes</td><td id="d3702e2044"><a name="d3702e2044"><!----></a><a name="d3702e2045"><!----></a>The document to generate documentation for, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e2050"><td id="d3702e2051"><a name="d3702e2051"><!----></a><a name="d3702e2052"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e2055"><a name="d3702e2055"><!----></a>out</td><td id="d3702e2057"><a name="d3702e2057"><!----></a>yes</td><td id="d3702e2059"><a name="d3702e2059"><!----></a><a name="d3702e2060"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="xpl3-include-docbook.xpl"><a name="xpl3-include-docbook.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.3.3</span> XProc (3.0) pipeline: <code class="code">include-docbook.xpl</code></h3><p class="para keep-with-next" id="d3702e2067"><a name="d3702e2067"><!----></a>File: <code class="code">transforms3/include-docbook.xpl</code></p><p class="para" id="d3702e2071"><a name="d3702e2071"><!----></a>Takes an XML document and unwraps the root element from it. It then copies all the children to the output, with the exception of any <code class="code">db:info</code> elements.</p><p class="para" id="d3702e2076"><a name="d3702e2076"><!----></a>It is the responsibility of the author to make sure that everything that results is in the DocBook (<code class="code">http://docbook.org/ns/docbook</code>) namespace!</p><p class="para" id="d3702e2081"><a name="d3702e2081"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e2086"><a name="d3702e2086"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/include-docbook.xpl&gt;
  &lt;xi:include href="path/to/xml/to/include.xml"/&gt;
&lt;/xdoc:transform&gt;</pre></div><div class="table nonumber" id="d3702e2088"><a name="d3702e2088"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e2095" class="thead-light"><tr id="d3702e2096"><th id="d3702e2097"><a name="d3702e2097"><!----></a>Port</th><th id="d3702e2099"><a name="d3702e2099"><!----></a>Type</th><th id="d3702e2101"><a name="d3702e2101"><!----></a>Primary?</th><th id="d3702e2103"><a name="d3702e2103"><!----></a>Description</th></tr></thead><tbody id="d3702e2105"><tr id="d3702e2106"><td id="d3702e2107"><a name="d3702e2107"><!----></a><a name="d3702e2108"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e2111"><a name="d3702e2111"><!----></a>in</td><td id="d3702e2113"><a name="d3702e2113"><!----></a>yes</td><td id="d3702e2115"><a name="d3702e2115"><!----></a><a name="d3702e2116"><!----></a>The document containing the parts to include, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e2121"><td id="d3702e2122"><a name="d3702e2122"><!----></a><a name="d3702e2123"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e2126"><a name="d3702e2126"><!----></a>out</td><td id="d3702e2128"><a name="d3702e2128"><!----></a>yes</td><td id="d3702e2130"><a name="d3702e2130"><!----></a><a name="d3702e2131"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div><div class="sect2" id="xpl3-xml-description.xpl"><a name="xpl3-xml-description.xpl"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.3.4</span> XProc (3.0) pipeline: <code class="code">xml-description.xpl</code></h3><p class="para keep-with-next" id="d3702e2138"><a name="d3702e2138"><!----></a>File: <code class="code">transforms3/xml-description.xpl</code></p><p class="para" id="d3702e2142"><a name="d3702e2142"><!----></a>Takes a document that <span class="emphasis italic">describes</span> an XML document, using special markup for this, and turns this into DocBook.</p><p class="para" id="d3702e2147"><a name="d3702e2147"><!----></a>A schema for this markup format can be found in <code class="code">xsd/element-description.xml</code>.</p><p class="para" id="d3702e2152"><a name="d3702e2152"><!----></a>Typical usage (within an <code class="code">xdoc</code> source document):</p><div class="programlisting" id="d3702e2157"><a name="d3702e2157"><!----></a><pre class="programlisting">&lt;xdoc:transform href="$xdoc/xml-description.xpl&gt;
  &lt;xi:include href="path/to/xml/description.xml"/&gt;
&lt;/xdoc:transform&gt;</pre></div><div class="table nonumber" id="d3702e2159"><a name="d3702e2159"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e2166" class="thead-light"><tr id="d3702e2167"><th id="d3702e2168"><a name="d3702e2168"><!----></a>Port</th><th id="d3702e2170"><a name="d3702e2170"><!----></a>Type</th><th id="d3702e2172"><a name="d3702e2172"><!----></a>Primary?</th><th id="d3702e2174"><a name="d3702e2174"><!----></a>Description</th></tr></thead><tbody id="d3702e2176"><tr id="d3702e2177"><td id="d3702e2178"><a name="d3702e2178"><!----></a><a name="d3702e2179"><!----></a><code class="code code-width-limited">source</code></td><td id="d3702e2182"><a name="d3702e2182"><!----></a>in</td><td id="d3702e2184"><a name="d3702e2184"><!----></a>yes</td><td id="d3702e2186"><a name="d3702e2186"><!----></a><a name="d3702e2187"><!----></a>The document containing the XML description, wrapped in an <code class="code">xdoc:transform</code> element.</td></tr><tr id="d3702e2192"><td id="d3702e2193"><a name="d3702e2193"><!----></a><a name="d3702e2194"><!----></a><code class="code code-width-limited">result</code></td><td id="d3702e2197"><a name="d3702e2197"><!----></a>out</td><td id="d3702e2199"><a name="d3702e2199"><!----></a>yes</td><td id="d3702e2201"><a name="d3702e2201"><!----></a><a name="d3702e2202"><!----></a>The resulting DocBook output.</td></tr></tbody></table></div></div></div><div class="sect1" id="sect-write-your-own-transformations"><a name="sect-write-your-own-transformations"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">3.4</span> Writing your own <code class="code">xdoc</code> transformations</h2><ul class="itemizedlist" id="d3702e2216"><a name="d3702e2216"><!----></a><li id="d3702e2218"><a name="d3702e2218"><!----></a><p class="para" id="d3702e2220"><a name="d3702e2220"><!----></a>To add an <code class="code">xdoc</code> transform of your own you need to write an XSLT stylesheet or an XProc pipeline.</p></li><li id="d3702e2227"><a name="d3702e2227"><!----></a><p class="para" id="d3702e2229"><a name="d3702e2229"><!----></a>Such a stylesheet or transformation gets the *full* <code class="tag">&lt;xdoc:transform&gt;</code> element as its input. It can inspect the
            <code class="tag">&lt;xdoc:transform&gt;</code> root element itself for its attributes.</p></li><li id="d3702e2239"><a name="d3702e2239"><!----></a><p class="para" id="d3702e2241"><a name="d3702e2241"><!----></a>The <code class="tag">&lt;xdoc:transform&gt;</code> element has an additional attribute <code class="code">xdoc:base-uri-source</code> that holds the URI of the source
          document. Useful when resolving other URI s.</p></li><li id="d3702e2251"><a name="d3702e2251"><!----></a><p class="para" id="d3702e2253"><a name="d3702e2253"><!----></a>The output of the stylesheet/pipeline must be the resulting (valid!) DocBook.</p></li><li id="d3702e2257"><a name="d3702e2257"><!----></a><p class="para" id="d3702e2259"><a name="d3702e2259"><!----></a>If the resulting DocBook contains multiple elements you can wrap them all in an <code class="tag">&lt;xdoc:GROUP&gt;</code> element to make the result a
          single well-formed document. The <code class="tag">&lt;xdoc:GROUP&gt;</code> wrapper is removed later on by the <code class="code">xdoc</code> processing.</p></li><li id="d3702e2273"><a name="d3702e2273"><!----></a><p class="para" id="d3702e2275"><a name="d3702e2275"><!----></a>You must reference your stylesheet or pipeline using <code class="tag">&lt;xdoc:transform&gt;</code>'s <code class="code">href</code> attribute.</p></li></ul><p class="para" id="d3702e2286"><a name="d3702e2286"><!----></a>Here is a simple example of something that is actually quite useful. Tables in DocBook are complex things. When you to have format the same
      kind of data over and over again in a table, it becomes very boring and hard to keep consistent and maintainable. Using <code class="code">xdoc</code>
      transforms you can automate the data to DocBook part.</p><p class="para" id="d3702e2292"><a name="d3702e2292"><!----></a>Assume we have, all over the document, weather data, that comes in this source format:</p><div class="programlisting" id="d3702e2295"><a name="d3702e2295"><!----></a><pre class="programlisting">&lt;weather-data&gt;
  &lt;data city="Amsterdam" temp="20"/&gt;
  &lt;data city="Stavanger" temp="-5"/&gt;
&lt;/weather-data&gt;</pre></div><p class="para keep-with-next" id="d3702e2299"><a name="d3702e2299"><!----></a>You want to show this as tables. The following XSLT stylesheet (called <code class="code">transform-weather-data.xsl</code>) will
      do the <code class="code">xdoc</code> transform trick. As its input it gets the weather data wrapped in the <code class="tag">&lt;xdoc:transform&gt;</code> element (see
      below).</p><div class="programlisting" id="d3702e2311"><a name="d3702e2311"><!----></a><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsl:stylesheet version="3.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:xdoc="http://www.xtpxlib.nl/ns/xdoc"
  xmlns="http://docbook.org/ns/docbook"&gt;

  &lt;xsl:template match="/"&gt;
    &lt;table&gt;
      &lt;title&gt;Example weather data&lt;/title&gt;
      &lt;tgroup cols="2"&gt;
        &lt;colspec colwidth="4cm"/&gt;
        &lt;colspec/&gt;
        &lt;thead&gt;
          &lt;row&gt;
            &lt;entry&gt;
              &lt;para&gt;City&lt;/para&gt;
            &lt;/entry&gt;
            &lt;entry&gt;
              &lt;para&gt;Temperature (C)&lt;/para&gt;
            &lt;/entry&gt;
          &lt;/row&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
          &lt;xsl:for-each select="/xdoc:transform/weather-data/data"&gt;
            &lt;row&gt;
              &lt;entry&gt;
                &lt;para&gt;
                  &lt;xsl:value-of select="@city"/&gt;
                &lt;/para&gt;
              &lt;/entry&gt;
              &lt;entry&gt;
                &lt;para&gt;&lt;xsl:value-of select="@temp"/&gt;&lt;/para&gt;
              &lt;/entry&gt;
            &lt;/row&gt;
          &lt;/xsl:for-each&gt;
        &lt;/tbody&gt;
      &lt;/tgroup&gt;
    &lt;/table&gt;
  &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</pre></div><p class="para keep-with-next" id="d3702e2314"><a name="d3702e2314"><!----></a>In your document you add:</p><div class="programlisting" id="d3702e2317"><a name="d3702e2317"><!----></a><pre class="programlisting">&lt;xdoc:transform href="path/to/transform-weather-data.xsl"&gt;
  &lt;xi:include href="path/to/your/weather/data.xml"/&gt;
&lt;/xdoc:transform&gt;</pre></div><p class="para keep-with-next" id="d3702e2320"><a name="d3702e2320"><!----></a>And the result for this example is:</p><div class="table" id="d3702e2323"><a name="d3702e2323"><!----></a><table class="table table-sm table-bordered"><thead id="d3702e2329" class="thead-light"><tr id="d3702e2330"><th id="d3702e2331"><a name="d3702e2331"><!----></a><a name="d3702e2332"><!----></a>City</th><th id="d3702e2334"><a name="d3702e2334"><!----></a><a name="d3702e2335"><!----></a>Temperature (C)</th></tr></thead><tbody id="d3702e2337"><tr id="d3702e2338"><td id="d3702e2339"><a name="d3702e2339"><!----></a><a name="d3702e2340"><!----></a>Amsterdam</td><td id="d3702e2342"><a name="d3702e2342"><!----></a><a name="d3702e2343"><!----></a>20</td></tr><tr id="d3702e2345"><td id="d3702e2346"><a name="d3702e2346"><!----></a><a name="d3702e2347"><!----></a>Stavanger</td><td id="d3702e2349"><a name="d3702e2349"><!----></a><a name="d3702e2350"><!----></a>-5</td></tr></tbody></table></div></div></div><script src="resources/jquery-3.4.1.slim.min.js"><!--  --></script><script src="resources/popper.min.js"><!--  --></script><script src="resources/bootstrap.min.js"><!--  --></script></body>
</html>